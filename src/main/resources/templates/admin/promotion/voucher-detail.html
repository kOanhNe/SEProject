<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Chi tiết voucher</title>
    <link rel="stylesheet" th:href="@{/css/admin.css}">
    <link rel="stylesheet" th:href="@{/css/common.css}">
</head>
<body>
<div class="admin-layout">
    <aside class="sidebar">
        <div th:replace="~{admin/sidebar :: sidebar}"></div>
    </aside>
    <div class="main">
        <header class="topbar">
            <div class="topbar-inner">
                <div class="topbar-left">
                    <button class="menu-toggle" aria-label="Toggle menu">☰</button>
                    <h3>Chi tiết voucher</h3>
                </div>
                <div class="topbar-right">
                    <a class="btn btn-secondary" th:href="@{/admin/promotions/vouchers}">Quay lại</a>
                    <a class="btn btn-primary" th:href="@{|/admin/promotions/vouchers/${voucher.voucherId}/edit|}">Sửa</a>
                </div>
            </div>
        </header>
        <main class="page-content">
            <div class="card" style="max-width: 900px; margin: 0 auto;">
                <!-- Header Section -->
                <div style="border-bottom: 2px solid #e5e7eb; padding-bottom: 20px; margin-bottom: 24px;">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                        <div>
                            <div style="background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%); display: inline-block; padding: 12px 24px; border-radius: 8px; margin-bottom: 12px;">
                                <span style="color: white; font-size: 24px; font-weight: 700; letter-spacing: 2px;" th:text="${voucher.code}">CODE123</span>
                            </div>
                            <h2 style="margin: 0; font-size: 24px; font-weight: 700;" th:text="${voucher.title}">Tiêu đề voucher</h2>
                        </div>
                        <span th:if="${voucher.enabled}" class="chip-on" style="font-size: 14px; padding: 8px 14px;">● Đang hoạt động</span>
                        <span th:unless="${voucher.enabled}" class="chip-off" style="font-size: 14px; padding: 8px 14px;">● Đã tắt</span>
                    </div>
                    <p style="color: #6b7280; font-size: 15px; margin: 0;" th:text="${voucher.description}">Mô tả voucher</p>
                </div>

                <!-- Campaign Info -->
                <div style="background: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 100%); border: 2px solid #d8b4fe; border-radius: 12px; padding: 20px; margin-bottom: 24px;">
                    <div style="color: #6b21a8; font-size: 13px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 8px;">Thuộc chiến dịch</div>
                    <div style="font-size: 20px; font-weight: 700; color: #7c3aed;" th:text="${voucher.campaign != null ? voucher.campaign.name : 'N/A'}">Tên chiến dịch</div>
                </div>

                <!-- Info Grid -->
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 24px; margin-bottom: 32px;">
                    <!-- Thời gian -->
                    <div style="background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); border-radius: 12px; padding: 20px; border-left: 4px solid #0284c7;">
                        <div style="color: #075985; font-size: 13px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 8px;">Thời gian hiệu lực</div>
                        <div style="font-size: 16px; font-weight: 600; color: #0c4a6e;">
                            <span th:text="${#temporals.format(voucher.startDate, 'dd/MM/yyyy')}">01/01/2024</span>
                            <span style="color: #64748b; margin: 0 8px;">→</span>
                            <span th:text="${#temporals.format(voucher.endDate, 'dd/MM/yyyy')}">31/12/2024</span>
                        </div>
                    </div>

                    <!-- Usage Limit -->
                    <div style="background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); border-radius: 12px; padding: 20px; border-left: 4px solid #f59e0b;">
                        <div style="color: #92400e; font-size: 13px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 8px;">Giới hạn sử dụng / khách</div>
                        <div style="font-size: 20px; font-weight: 700; color: #b45309;">
                            <span th:if="${voucher.maxRedeemPerCustomer != null}" th:text="${voucher.maxRedeemPerCustomer} + ' lần'">3 lần</span>
                            <span th:unless="${voucher.maxRedeemPerCustomer != null}" style="font-size: 16px;">Không giới hạn</span>
                        </div>
                    </div>
                </div>

                <!-- Discount Rules (inherited from campaign) -->
                <div style="background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%); border: 2px solid #86efac; border-radius: 12px; padding: 24px; margin-bottom: 32px;">
                    <h3 style="margin: 0 0 8px 0; font-size: 18px; font-weight: 700; color: #166534;">Quy tắc giảm giá</h3>
                    <div style="color: #15803d; font-size: 13px; margin-bottom: 16px;">(Kế thừa từ chiến dịch)</div>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px;">
                        <div>
                            <div style="color: #15803d; font-size: 13px; font-weight: 600; margin-bottom: 4px;">Loại giảm giá</div>
                            <div style="font-size: 16px; font-weight: 600; color: #166534;">
                                <span th:if="${voucher.discountType.name() == 'PERCENT'}">Phần trăm (%)</span>
                                <span th:if="${voucher.discountType.name() == 'FIXED_AMOUNT'}">Số tiền cố định (VNĐ)</span>
                            </div>
                        </div>
                        <div>
                            <div style="color: #15803d; font-size: 13px; font-weight: 600; margin-bottom: 4px;">Giá trị giảm</div>
                            <div style="font-size: 24px; font-weight: 700; color: #166534;">
                                <span th:text="${voucher.discountValue}">10</span>
                                <span th:if="${voucher.discountType.name() == 'PERCENT'}">%</span>
                                <span th:if="${voucher.discountType.name() == 'FIXED_AMOUNT'}"> VNĐ</span>
                            </div>
                        </div>
                        <div>
                            <div style="color: #15803d; font-size: 13px; font-weight: 600; margin-bottom: 4px;">Giảm tối đa</div>
                            <div style="font-size: 16px; font-weight: 600; color: #166534;">
                                <span th:if="${voucher.maxDiscountValue != null}">
                                    <span th:text="${#numbers.formatDecimal(voucher.maxDiscountValue, 0, 'COMMA', 0, 'POINT')}">100,000</span> VNĐ
                                </span>
                                <span th:unless="${voucher.maxDiscountValue != null}" style="color: #9ca3af;">Không giới hạn</span>
                            </div>
                        </div>
                        <div>
                            <div style="color: #15803d; font-size: 13px; font-weight: 600; margin-bottom: 4px;">Đơn hàng tối thiểu</div>
                            <div style="font-size: 16px; font-weight: 600; color: #166534;">
                                <span th:if="${voucher.minOrderValue != null}">
                                    <span th:text="${#numbers.formatDecimal(voucher.minOrderValue, 0, 'COMMA', 0, 'POINT')}">500,000</span> VNĐ
                                </span>
                                <span th:unless="${voucher.minOrderValue != null}" style="color: #9ca3af;">Không yêu cầu</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="detail-actions">
                    <a th:href="@{|/admin/promotions/vouchers/${voucher.voucherId}/edit|}" class="btn btn-primary" style="padding: 10px 24px;">
                        Chỉnh sửa voucher
                    </a>
                    <a th:href="@{/admin/promotions/vouchers}" class="btn btn-secondary" style="padding: 10px 24px; margin-left: auto;">
                        Quay lại danh sách
                    </a>
                </div>
            </div>
        </main>
    </div>
</div>
<script>
    document.addEventListener('click', function (e) {
        if (!e.target.matches('.menu-toggle')) return;
        const sidebar = document.querySelector('.sidebar');
        if (sidebar) sidebar.classList.toggle('collapsed');
    });
</script>
</body>
</html>
